<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <script>
        const config = {
            initial: 'normal',
            states: {
                normal: {
                    transitions: {
                        study: 'busy',
                    }
                },
                busy: {
                    transitions: {
                        get_tired: 'sleeping',
                        get_hungry: 'hungry',
                    }
                },
                hungry: {
                    transitions: {
                        eat: 'normal'
                    },
                },
                sleeping: {
                    transitions: {
                        get_hungry: 'hungry',
                        get_up: 'normal',
                    },
                },
            }
        };
    </script>
    <script>
    class FSM {
        /**
         * Creates new FSM instance.
         * @param config
         */
        constructor(config) {
            this.config = config;
            this.state = config.initial;
            this.hist = [];
            this.hist.push(this.state);
            this.chist=[];
        }

        /**
         * Returns active state.
         * @returns {String}
         */
        getState() {
            return this.state;
        }

        /**
         * Goes to specified state.
         * @param state
         */
         getState() {
             return this.state;
         }

         /**
          * Goes to specified state.
          * @param state
          */
         changeState(state) {
         if (state in this.config.states){
       this.hist.push(this.state);
       this.state = state;
       }else {
         try {
         throw Error;
          }
          catch (e) {

          }
        }
     }
        /**
         * Changes state according to event transition rules.
         * @param event
         */
        trigger(event) {
           this.chist.push(event);
            this.hist.push(this.state);
            this.state = this.config.states[this.state].transitions[event];

        }

        /**
         * Resets FSM state to initial.
         */
        reset() {
            this.hist.push(this.state);
            this.state = config.initial;

        }

        /**
         * Returns an array of states for which there are specified event transition rules.
         * Returns all states if argument is undefined.
         * @param event
         * @returns {Array}
         */
        getStates(event) {
            /*
    (anonymous) @ VM2335:1
    'busy' in student.config.states
    true
    Object.keys(student.config.states)

    */
            this.getSt = [];
            this.cstat = [];
            this.cstat = Object.keys(student.config.states);
            this.counter = 0;
            for (var key in this.config.states) {
                this.counter++;
            }
            if (event == undefined) {

                return this.cstat;
            } else {
                for (let i = 0; i < this.counter; i++) {
                    if (event in this.config.states[this.cstat[i]].transitions)
                        this.getSt.push(this.cstat[i]);
                }

            }
            return this.getSt;
        }
        /**
         * Goes back to previous state.
         * Returns false if undo is not available.
         * @returns {Boolean}
         */
        undo() {

            if (this.hist.length == 0) {
                return false;

            } else {
               this.state = this.hist.pop();


            }


        }

        /**
         * Goes redo to state.
         * Returns false if redo is not available.
         * @returns {Boolean}
         */
        redo() {
          if (this.chist.length == 0) {
              return false;

          } else {
             this.trigger(this.chist.pop());
             this.hist.pop();

          }


        }

        /**
         * Clears transition history
         */
        clearHistory() {
          this.hist = [];
          this.chist = [];

        }
    }
    student = new FSM(config)
    </script>
</body>

</html>
